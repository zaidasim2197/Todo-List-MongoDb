<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zaid's Air Share</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.2/axios.min.js"></script>
</head>
<style>

    body{
        columns: auto ;  
        font-size: 17px;
        background-image: url("https://citrusbits.com/wp-content/uploads/2021/02/AdobeStock_305109236-scaled.jpeg")
    }
    * {
        box-sizing: border-box;
        
    }
    
 .container1{
   display: block;
   margin-left: 41%;
   margin-right: 41%;
   width: 30%;   
   
 }
.container1.button{
    width: 20%;
}


    input[type=text] {
        
        padding: 16px 20px;
        margin: 10px ;
        border-radius: 25px;
        height: 10px;
        border-color: #6b4646;
    }

    button {
        background-color:  rgb(215, 224, 231);
        color: rgb(0, 0, 0);
        padding: 10px 15px;
        margin: 15px 5px;
        border-radius: 15px;
        width: 8%;
        border-color: rgb(43, 40, 40);
        box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
        float: center;
        cursor: pointer;
        transition: all 0.15s;
    
    }
    #ghli{
        
    box-shadow: 5px 5px 4px 1px rgb(64, 77, 96);
  margin-left: 1px;
  margin-right: 1px;
    }
    #result{
        border: 2px rgb(193, 214, 232);
        border-radius: 7px;
      background-color: rgb(202, 215, 226);
        border-style: solid;
        margin-top: 10px;
        margin-bottom: 10px;
        margin-right: 250px;
        margin-left: 250px;
    }
    button:hover{
        opacity: 0.8;
    }
    input:hover{
        opacity: 0.8;
    }
    .btn-btn-primary{
    color: black;

}


.current h3{
    margin-left: -45%;
    width: 95%;
    text-align:start;
    
}

#btns{
            display: flex;
            justify-content:right;
            width: 100%;
            height: 13vh;
           text-align: right;
           margin-top: -45px;
           
        }
        #userInput {
            display: flex;
            font-family:Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
            font-size: 25px;
            background-color: rgb(186, 215, 239);

        }
</style> 

<body>
    
   <div id="ghli">
    <center><u><i><h2 style="color: rgb(215, 224, 231)  ;">"To-Do List Application"</h2></u></i></center>
</div>
<div class="container1">


    <button style="width: 84px; background-color: rgb(98, 103, 113)  ;  margin-right: -15px; box-shadow: 5px 5px 4px 1px rgb(64, 77, 96);">
    <i class="fa fa-github" style="color: black; font-size: 17px;"></i> <a href="https://github.com/zaidasim2197">github</a><br> </button>
    
    <button style="width: 95px;background-color: #3476a9 ; margin-left: 15px ; box-shadow: 5px 5px 4px 1px rgb(64, 77, 96); ">
    <i class="fa fa-facebook" style="color: black;  font-size: 15px;"></i><a href="https://www.facebook.com/zaid.asim.1238">Facebook</a></button>
    <!-- <i><h1 style=" margin-left: 38%;text-shadow: black;"><u style="color: rgb(71, 53, 53); ">"Share On Air"</u></h1></i> -->
  
    
   
    </div>
   
        <form onsubmit="postTodo(); return false">
            
           
          <b style="font-size: 22px; color:rgb(215, 224, 231) ; "><u><i>Enter:</i></u></b>
        <input id="todo" type="text" style="width: 75% ; margin-right: 15px; padding: 18px ; box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);" placeholder="New Task.." >
          <button  type="submit"style="width: 12% ; ">Add</button><center>
            
        </form>

        <button onclick="getAllTodos()"style="width: 12% ; ">Refresh</button>
        <button onclick="getDelete()" style="width: 12% ; ">Delete All</button>
    
        <div  class="current">
            <h3 id="current"> </h3><hr>
        </div>
    


    </center>
  

    <script>

let api = 'https://desert-sand-dhole-shoe.cyclic.app'

        function postTodo() {
            let todoText = document.querySelector("#todo").value

            axios.post(`https://desert-sand-dhole-shoe.cyclic.app/todo`, {
                text: todoText
            })
                .then(function (response) {

 
                    console.log(response.data);

                    document.querySelector("#result").innerHTML = response.data.message;

                    // response.data.data.map(eachTodo => {
                    //     document.querySelector("#result").innerHTML += eachTodo
                    //     document.querySelector("#result").innerHTML += '<br>'
                    // })

                })
                .catch(function (error) {
                    console.log(error.response.data);
                })

        }

        function getAllTodos() {
            axios.get(`https://desert-sand-dhole-shoe.cyclic.app/todos`)
                .then(function (response) {
                    console.log(response.data);
                    document.querySelector("#current").innerHTML =
                `         <h3 id="result"> </h3>`
                response.data.data.map(eachtodo => {
document.querySelector("#result").innerHTML += ` <div id="userInput">${eachtodo.text}</div><div id="btns"><button onclick='deleteTodos(\`${JSON.stringify(eachtodo)}\`)'  class="btn btn-primary" >Del</button>
    <button onclick='editTodos(\`${JSON.stringify(eachtodo)}\`)' class="btn btn-primary " >Edit</button></div>`
// document.querySelector("#result").innerHTML += "<br>"

});
                
                
})
                .catch(function (error) {
                    console.log(error);
                })
        }
        

setInterval(getAllTodos, 700);

function deleteTodos (data_json){
                
                    const data = JSON.parse(data_json)
                    let code = prompt("Enter Password ")
            if (code === "123") {
                    axios.delete(`${api}/todos/${data._id}`)
                
                    .then(function (response){
                        getAllTodos()
                        console.log(response)
                    })
                    .catch((error) => {
                console.log(error)
            })}
            }

function editTodos(data_json) {

    let changeText = prompt("Enter Updated Todo");
    if (changeText === ""){
        alert("You can't leave it blank")
        editTodos()
    }
    else{
        const data = JSON.parse(data_json)
        const text = changeText;
        axios.put(`${api}/edit/${data._id}`)

          
        .then(function (response){
                        getAllTodos()
                        console.log(response)
                    })
                    .catch((error) => {
                console.log(error)
            })
// response.data.data.text === response.data.data.changeText;

    //                 response.data.data.map(eachTodo => {
    //                     document.querySelector("#result").innerHTML += eachTodo.changeText    
    // }
                    // )}
}
    
}
                   
    function getDelete() {
         
            let code = prompt("Enter Password ")
            if (code === "123") {
                axios.delete('https://desert-sand-dhole-shoe.cyclic.app//del')
            .then(function (response) {
                    console.log(response.data);
            
                })    
                .catch((error) => {
                console.log(error)
            })}
        
        }
    
    </script>

</body>

</html>